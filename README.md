# Exchange Online: Tenant-to-tenant migration script

**Overview:**

This repository contains two scripts to sync of all necessary attributes between the source and target tenant before the MRS move-mailbox.

**How it works:**

- 1 Fill some Exchange custom attributes (1-15) with any value. This will become the filter for the script to get only mailboxes with the attribute that you choose.

- 2 Understand all parameters that you may use to run the script. You can find all parameters description in this page or in the script.

- 3 Run the script *Cross-Tenant-Migration-Attribute-Export.ps1* to dump the source mailboxes and confirm that the CSV generated by the script contains only mailboxes that you filter by the custom attribute.

- 4 Run the *Cross-Tenant-Migration-Attribute-Import.ps1* to create Mail User objects (aka MEU) in the target on-prem AD. The script will stop Azure AD Connect sync cycle or ask you to do yourself before the execution. The reason is because you might validate that all MEU objects are properly created before sync it.

- 5 Re-enable the Azure AD Connect sync cycle manually – the script will not do this for you but will provide you the cmdlet to do when you are ready. 

**Attributes:**

The first script will dump to a CSV the following attributes:

- ExchangeGuid
- EmailAddresses
- ExternalEmailAddress
- legacyExchangeDN
- PrimarySMTPAddress
- alias
- FirstName
- LastName
- DisplayName
- Name
- SamAccountName
- LitigationHoldEnabled
- SingleItemRecoveryEnabled
- ArchiveDatabase
- ArchiveGuid
- msExchSafeSendersHash
- msExchSafeRecipientsHash
- msExchBlockedSendersHash
- CustomAttribute ¹
- CustomAttribute Value ¹
- MailboxLocations ²

¹The custom attribute number and value that will be dumped is chosen according to the user’s input before running the script

²The script doesn’t really dump MailboxLocations to a CSV but it dumps the UserDisplayName from any users that might have an Auto-Expanding archive mailbox to a TXT. This is not a requirement for the migration itself, but as Microsoft doesn’t support the Auto-Expanding archive mailbox migration the script dumps it to make you aware of. 

    >[!Note]
    > This sample script is provided AS IS and not supported under any Microsoft standard support program, service and without warranty of any kind.
